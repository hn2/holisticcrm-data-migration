DROP TABLE IF EXISTS z_target.Deals;

-- CREATE TABLE z_target.Deals AS
-- SELECT *

-- SELECT new_cs1_town_idName, cs1_voucher_nameName, cs1_student_recYomiName, ParentContactIdName, cs1_student_recName, ModifiedOnBehalfByYomiName, CreatedByName, new_discount2_approving_manageridYomiName, PriceLevelIdName, cs1_phonecallToOpenName, new_discount1_reasonName, cs1_last_psicoYomiName, cs1_list_of_schools_opportunityName, ModifiedOnBehalfByName, new_discount2_reasonName, CampaignIdName, ModifiedByName, new_discount3_approving_manageridName, new_discount1_approving_manageridName, new_discount3_reasonName, new_discount2_approving_manageridName, new_discount1_approving_manageridYomiName, cs1_requested_siteName, TransactionCurrencyIdName, ParentContactIdYomiName, cs1_yoatsmName, new_discount3_approving_manageridYomiName, cs1_voluntary_association_nameName, cs1_club_disc_nameName, cs1_last_psicoName, ParentAccountIdYomiName, cs1_supplierName, CreatedOnBehalfByYomiName, ModifiedByYomiName, cs1_distribution_agreements_listName, cs1_yoatsmYomiName, ParentAccountIdName, OriginatingLeadIdName, CreatedOnBehalfByName, CreatedByYomiName, OriginatingLeadIdYomiName, OwnerId, OwnerIdName, OwnerIdYomiName, OwnerIdDsc, OwnerIdType, OwningUser, OwningTeam, AccountId, AccountIdName, AccountIdYomiName, ContactId, ContactIdName, ContactIdYomiName, OpportunityId, PriceLevelId, OpportunityRatingCode, PriorityCode, Name, StepId, Description, EstimatedValue, StepName, SalesStageCode, ParticipatesInWorkflow, PricingErrorCode, EstimatedCloseDate, CloseProbability, ActualValue, ActualCloseDate, OwningBusinessUnit, OriginatingLeadId, CreatedOn, IsPrivate, CreatedBy, ModifiedOn, ModifiedBy, VersionNumber, StateCode, StatusCode, IsRevenueSystemCalculated, CustomerId, CustomerIdName, CustomerIdType, CampaignId, TransactionCurrencyId, ExchangeRate, ImportSequenceNumber, UTCConversionTimeZoneCode, TimeZoneRuleVersionNumber, OverriddenCreatedOn, ActualValue_Base, EstimatedValue_Base, CustomerIdYomiName, TotalTax, DiscountPercentage, TotalAmount, DiscountAmount, TotalAmountLessFreight, FreightAmount, TotalLineItemDiscountAmount, TotalLineItemAmount, TotalDiscountAmount, TotalLineItemAmount_Base, TotalDiscountAmount_Base, TotalTax_Base, DiscountAmount_Base, TotalLineItemDiscountAmount_Base, TotalAmount_Base, TotalAmountLessFreight_Base, FreightAmount_Base, CreatedOnBehalfBy, ModifiedOnBehalfBy, BudgetStatus, DecisionMaker, Need, TimeLine, BudgetAmount, BudgetAmount_Base, ParentAccountId, ParentContactId, EvaluateFit, InitialCommunication, ConfirmInterest, ScheduleFollowup_Prospect, ScheduleFollowup_Qualify, ScheduleProposalMeeting, FinalDecisionDate, DevelopProposal, CompleteInternalReview, CaptureProposalFeedback, ResolveFeedback, PresentProposal, SendThankYouNote, SalesStage, CompleteFinalProposal, FileDebrief, PursuitDecision, CustomerPainPoints, CustomerNeed, ProposedSolution, QualificationComments, QuoteComments, PurchaseProcess, PurchaseTimeframe, IdentifyCustomerContacts, IdentifyCompetitors, IdentifyPursuitTeam, CurrentSituation, PresentFinalProposal, cs1_age, cs1_discount, cs1_discounttype, cs1_interest_type, cs1_internal_number, cs1_source_opp, cs1_totalprice, cs1_totalprice_Base, cs1_totalpricewithoutdis, cs1_totalpricewithoutdis_Base, cs1_supplier, cs1_requested_site, cs1_changedbyconv, cs1_changeddateconv, cs1_convid, cs1_createdbyconv, cs1_createddateconv, cs1_convowner, cs1_convstatecode, cs1_convstatus, cs1_Percentdisc, cs1_percentdisc_Base, cs1_totaldisc, cs1_totaldisc_Base, cs1_coursecounter, cs1_creatednow, cs1_phonecallToOpen, cs1_list_of_schools_opportunity, cs1_Requested_branch, cs1_First_Lesson, cs1_class_mygeva, cs1_Interested_mygeva, cs1_Questionnaire_num, cs1_Payment_branch, cs1_student_rec, cs1_first, cs1_sec, cs1_3, cs1_akalot, new_discount1_reason, new_discount2_reason, new_discount3_reason, cs1_2_class, cs1_32014, cs1_3201444, cs1_first_class, cs1_hakalot, new_conference_name, new_cs1_high_school_student, new_discount1_approving_managerid, new_discount2_approving_managerid, new_discount3_approving_managerid, cs1_yoatsm, cs1_last_psico, cs1_need_eng_for, cs1_occupation, cs1_eng_level, cs1_english_term, cs1_english_course_reqired, cs1_english_year, cs1_cours_not_exist, cs1_is_serviceappointment_set, cs1_yoats, new_cs1_town_id, cs1_other, cs1_voucher_name, cs1_club_disc_name, cs1_voluntary_association_name, cs1_voucher_num, cs1_campaign_utm, cs1_utm_term, cs1_source_utm, cs1_utm_medium, cs1_utm_conten, cs1_distribution_agreements_list, cs1_call_marker_tag
-- FROM z_source.opporotunity;

create table z_target.Deals AS
SELECT  CustomerId AS 'Account_Name', -- Lookup	Accounts
		cs1_requested_site AS 'Branch', -- Lookup	Branches
		OwnerId	AS 'Owner', --	Lookup	Users
		cs1_interest_type AS 'Interest', --	String	
		cs1_source_utm AS 'Lead_Source', --	String	
		cs1_hakalot AS 'Hakalot', --	Boolean	
		cast(cs1_totalprice as decimal) AS 'Amount', --	Currency	
		cast(TotalAmount as decimal) AS 'Amount_after_discount', --	Currency	
		originatingleadid AS 'ConvertedFromLead' --	Lookup	Leads
FROM z_source.opporotunity;

select *
FROM z_target.Deals;